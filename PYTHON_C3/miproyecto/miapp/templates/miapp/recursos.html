{% extends 'miapp/base.html' %}
{% load static %}

{% block title %}Recursos - SoulComfort{% endblock %}

{% block content %}
<div class="container py-4">
    <div class="row">
        <div class="col-12">
            <!-- Header Mejorado -->
            <div class="text-center mb-4">
                <h1 class="h fw-bold text-primary mb-2">
                    Recursos de Bienestar
                </h1>
                <p class="lead text-muted">Explora nuestras herramientas y recursos para tu crecimiento emocional</p>
                <div class="welcome-badge bg-primary text-white">
                    Kit de Herramientas Digitales
                </div>
            </div>

            <!-- Mensaje para pasantes en modo usuario -->
            {% if user.userprofile.tipo_usuario == 'pasante' and request.session.viewing_as_user %}
            <div class="alert alert-info mb-5">
                <i class="fas fa-eye me-2"></i>
                <strong>Estás en modo de previsualización:</strong> Viendo el sitio como lo vería un usuario normal.
                <a href="{% url 'miapp:volver_a_pasante' %}" class="btn btn-sm btn-outline-info ms-3">
                    Volver a Pasante
                </a>
            </div>
            {% endif %}

            <!-- Sección de Kit de Herramientas -->
            <div class="row mb-5">
                <div class="col-12">
                    
                    
                    <div class="row">
                        {% for recurso in recursos_kit %}
                        <!-- Tarjeta Dinámica -->
                        <div class="col-lg-4 col-md-6 mb-4">
                            <div class="card resource-card h-100">
                                <div class="card-header bg-gradient-{{ recurso.color }} text-white text-center py-4">
                                    <i class="{{ recurso.icono }} fa-3x mb-3"></i>
                                    <h5 class="card-title mb-0">{{ recurso.titulo }}</h5>
                                </div>
                                <div class="card-body d-flex flex-column">
                                    <p class="card-text flex-grow-1">
                                        {{ recurso.descripcion }}
                                    </p>
                                    <div class="resource-meta mb-3">
                                        <small class="text-muted">
                                            <i class="fas fa-file me-1"></i>
                                            {{ recurso.get_tipo_archivo_display|upper }} • {{ recurso.tamaño }}
                                        </small>
                                        <br>
                                        <small class="text-muted">
                                            <i class="fas fa-download me-1"></i>
                                            {{ recurso.descargas }} descargas
                                        </small>
                                    </div>
                                    <a href="{% url 'miapp:descargar_recurso_kit' recurso.id %}" 
                                       class="btn btn-{{ recurso.color }} btn-download" 
                                       data-recurso-id="{{ recurso.id }}">
                                        <i class="fas fa-download me-2"></i>Descargar
                                    </a>
                                </div>
                            </div>
                        </div>
                        {% empty %}
                        <div class="col-12">
                            <div class="alert alert-info text-center">
                                <i class="fas fa-info-circle me-2"></i>
                                Próximamente estarán disponibles nuevos recursos en el kit de herramientas.
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>

               
            <!-- CTA Section -->
            <div class="text-center mt-5">
                <div class="cta-section text-white py-5 px-3 rounded-3">
                    <div class="row justify-content-center">
                        <div class="col-lg-8">
                            <div class="position-relative z-1">
                                <i class="fas fa-heart fa-3x mb-4" style="opacity: 0.8;"></i>
                                <h2 class="fw-bold mb-3">¿Buscas algo específico?</h2>
                                <p class="mb-4 fs-5">Nuestro equipo de pasantes está disponible para crear contenido personalizado según tus necesidades particulares.</p>
                                <a href="{% url 'miapp:tests' %}" class="btn btn-light btn-lg px-4 py-2 fw-bold">
                                    <i class="fas fa-clipboard-list me-2"></i>Realizar Test
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    /* Tus estilos CSS existentes se mantienen igual */
    .feature-card {
        border: none;
        border-radius: 15px;
        box-shadow: 0 5px 20px rgba(108, 99, 255, 0.1);
        transition: all 0.3s ease;
    }
    
    .feature-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 30px rgba(108, 99, 255, 0.2);
    }
    
    .resource-card {
        border: none;
        border-radius: 15px;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
        transition: all 0.3s ease;
        overflow: hidden;
    }
    
    .resource-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
    }
    
    .resource-card .card-header {
        border-bottom: none;
    }
    
    .bg-gradient-primary { background: linear-gradient(135deg, #6C63FF 0%, #8A82FF 100%); }
    .bg-gradient-success { background: linear-gradient(135deg, #28a745 0%, #20c997 100%); }
    .bg-gradient-info { background: linear-gradient(135deg, #17a2b8 0%, #6f42c1 100%); }
    .bg-gradient-warning { background: linear-gradient(135deg, #ffc107 0%, #fd7e14 100%); }
    .bg-gradient-danger { background: linear-gradient(135deg, #dc3545 0%, #e83e8c 100%); }
    .bg-gradient-secondary { background: linear-gradient(135deg, #6c757d 0%, #495057 100%); }
    
    .btn-download {
        border: none;
        border-radius: 8px;
        padding: 10px 20px;
        font-weight: 600;
        transition: all 0.3s ease;
    }
    
    .btn-download:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    }
    
    .resource-meta {
        border-top: 1px solid #eee;
        padding-top: 10px;
    }
    
    .cta-section {
        background: linear-gradient(135deg, #6C63FF 0%, #8A82FF 100%);
    }
    
    .welcome-badge {
        display: inline-block;
        padding: 8px 20px;
        border-radius: 25px;
        font-size: 0.9rem;
        font-weight: 500;
    }
</style>

<script>
    // Script para manejar las descargas con feedback visual
    document.addEventListener('DOMContentLoaded', function() {
        const downloadButtons = document.querySelectorAll('.btn-download');
        
        downloadButtons.forEach(button => {
            button.addEventListener('click', function(e) {
                const button = this;
                const originalHTML = button.innerHTML;
                
                // Mostrar estado de carga
                button.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Descargando...';
                button.disabled = true;
                
                // El enlace se abrirá después de la animación
                setTimeout(() => {
                    // Restaurar botón después de 3 segundos (simulando descarga)
                    setTimeout(() => {
                        button.innerHTML = '<i class="fas fa-check me-2"></i>Descargado';
                        setTimeout(() => {
                            button.innerHTML = originalHTML;
                            button.disabled = false;
                        }, 2000);
                    }, 1000);
                }, 500);
            });
        });
    });
</script>
{% endblock %}